# 인터넷 통신

- 복잡한 인터넷망에서 메세지를 주고받으려면 최소한의 규칙이 존재해야 한다.  
  이때 IP주소라는걸 통해서 이러한 통신을 가능하게 한다.

## IP(Internet Protocol)

- 인터넷으로 메시지를 보내기 위해서는 Internet Protocol이 필요하다
- 패킷이라는 단위로 전달한다.  
  패킷이란 패키지(수하물)와 버킷(덩어리)의 합성어이다.
- 전송 단위인 패킷에 나의 IP, 상대방 IP, 전송할 메시지가 들어있다.
- 인터넷망에 이 패킷이 던져지면 다양한 서버들은 정해놓은 규칙에 따라 서로 노드끼리 패킷을 전달-전달-전달하면서 최종적으로 상대방 IP에 패킷이 도착하게 된다.
- 하지만 이 IP만 가지고는 메세지를 신뢰하기도 어렵고, 포트라는 개념도 없다.
- 전송할 때 순서가 꼬일수도 있다.

### IP 프로토콜의 한계

- 비연결성
  - 패킷을 받을 대상이 없거나 서비스 불능 상태여도 패킷이 전송된다.
- 비신뢰성
  - 중간에 패킷을 던지면서 패킷이 사라지거나, 패킷을 여러개 보냈을 때 순서대로 오지 않는 문제
- 프로그램 구분
  - 같은 IP를 사용할때 여러 프로그램을 사용하면 (하나의 컴퓨터로 인터넷을 하면서 음악도 듣고 게임도 듣고 할때와 같이) IP를 구분하기 어려움

## 인터넷 프로토콜 스택의 4계층

1. 애플리케이션 계층 - HTTP, FTP
2. 전송 계층 - TCP, UDP
3. 인터넷 계층 - IP
4. 네트워크 인터페이스 계층
   > 위 IP 설명처럼 기능이 부족한 IP위해 TCP라는것을 추가해서, 기존 IP의 문제점을 보완시켜준다.

## TCP(Transmission Controll Protocol)

- Hello Word 라는 메시지를 보낸다면, SOCKET 라이브러리를 통해 전달하고 그것을 OS 계층으로 보낸다. 그리고 OS 계층에서 TCP 정보를 감싼다.
  - TCP 정보 : 출발지 포트, 목적지 포트, 전송 제어, 순서, 검증 정보들이 들어있다.
  - 그래서 IP만으로 안됬던 순서가 이상하게 전송이 될 수 있었던 문제가 해결이 된다.
- TCP로 감싸진 정보를 인터넷계층에서 IP로 한번 더 감싼다. (IP 패킷 생성)
- TCP 특징
  - 연결지향 - TCP 3 way handshake (가상 연결)
    - 클라이언트가 SYN을 보내고 서버에서 SYN을 받게되면 클라이언트에게 SYN+ACK를 보낸다. 그리고 다시 클라이언트는 ACK을 보낸다.
    - 요즘에는 최적화가 잘 되어있어서 마지막 ACK를 보낼 때 메세지를 같이 전송한다.
    - SYN : 접속 요청
    - ACK : 요청 수락
  - 데이터 전달 보증
    - 내가 메세지를 보냈는데 패킷이 중간에 누락되면 내가 알 수 있다.
    - 내가 데이터를 보내면 받는 쪽에서 잘 받았다고 응답을 해준다.
  - 순서 보장
    - 패킷1번, 패킷2번, 패킷3번을 보낸다고 가정하면 패킷2번이 도착해야하는데 패킷 3번부터 도착했다면 다 버리고 다시 패킷2번부터 보내라고 요청을 보낸다.

> 정리  
> IP 패킷 안에는 <b>출발지 IP, 목적지 IP, 기타 정보가 존재</b>한다.  
> TCP/IP 패킷 안에는 <b>출발지 IP, 목적지 IP, 기타 정보, 출발지 포트, 목적지 포트, 전송 제어, 순서, 검증 정보가 존재</b>한다.

## UDP

- IP와 동일하지만 Port가 추가되는 백지 상태이다.
- 요즘은 이 UDP를 이용하는 것을 선호한다.  
  그 이유는 TCP는 이미 많이 둘러 쌓여 있어서 건드릴 수 없지만 이 UDP는 애플리케이션에서 확장해서 사용해 볼 수 있기 때문이다.

## PORT

- 같은 IP에서 통신하는 애플리케이션을 구분하기 위해서 사용한다.
- 쉽게 이야기해서 IP가 아파트라고 하면 포트는 몇동 몇호라고 생각하면 된다.

## DNS

- 도메인 명을 외우기 힘든데 그것에 이름을 붙여 쉽게 사용할 수 있다.
- 전화번호부는 예를 들면 쉬운데 이름을 등록해 놓으면 그 이름에만 접근하면 되고 내부적으로 IP가 바뀌면 전화번호를 바꾸는 것 처럼 IP주소를 바꿔주면 된다.
